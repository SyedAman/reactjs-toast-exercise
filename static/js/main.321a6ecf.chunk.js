(this["webpackJsonptoast-exercise"]=this["webpackJsonptoast-exercise"]||[]).push([[0],{91:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),s=r(28),i=r.n(s),c=r(121),o=r(16),u=r(18),l=r.n(u),m=r(37),d=r(26),b=r(53),h=r(54),f=r(63),k=r(62),S=r(122),p=r(123),j=r(124),v=r(125),x=r(127),O=r(128),y=r(126),F=r(58),g=r.n(F),w=r(55),L=new(r.n(w).a),T=[];function N(){return Math.floor(100*Math.random())}function I(){return C.apply(this,arguments)}function C(){return(C=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){setTimeout((function(){if(N()<10)t({status:500,message:"server error"});else try{e({status:200,formSubmissions:JSON.parse(localStorage.getItem("formSubmissions"))||[]})}catch(r){t({status:500,message:r.message})}}),N()/100*3e3)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e){return U.apply(this,arguments)}function U(){return(U=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){setTimeout((function(){if(N()<10)r({status:500,message:"server error"});else try{var a=JSON.parse(localStorage.getItem("formSubmissions"))||[],n=[].concat(Object(o.a)(a),[t]);localStorage.setItem("formSubmissions",JSON.stringify(n)),e({status:202,message:"Success!"})}catch(s){r({status:500,message:s.message})}}),N()/100*3e3)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var D=r(2);function M(){return Object(D.jsx)(p.a,{sx:{flexGrow:1},children:Object(D.jsx)(j.a,{position:"static",children:Object(D.jsxs)(v.a,{children:[Object(D.jsx)(y.a,{edge:"start",color:"inherit","aria-label":"menu",sx:{marginRight:2},children:Object(D.jsx)(g.a,{})}),Object(D.jsx)(x.a,{variant:"h6",sx:{flexGrow:1},children:"Toast Exercise"}),Object(D.jsx)(O.a,{variant:"contained",size:"small",color:"secondary",onClick:function(){return function(){var e={id:L.guid(),data:{email:L.email(),firstName:L.first(),lastName:L.last(),liked:!1}};T.forEach((function(t){return t(e)}))}()},children:"New Submission"})]})})})}function P(e){var t=e.likedForm;return Object(D.jsxs)(x.a,{variant:"body1",sx:{fontStyle:"italic",marginTop:1},children:[t.id," | ",t.data.firstName," | ",t.data.lastName]})}function z(e){return e.map((function(e){return Object(D.jsx)(P,{likedForm:e},e.id)}))}function E(e){var t=e.likedForms;return Object(D.jsxs)(p.a,{sx:{marginTop:3},children:[Object(D.jsx)(x.a,{variant:"h4",children:"Liked Form Submissions"}),z(t)]})}var G=r(60),B=r.n(G),R=r(118);var W=function(e){var t=e.open,r=e.lastSubmittedForm,a=e.onClose,s=e.onLike,i=Object(D.jsxs)(n.a.Fragment,{children:[Object(D.jsx)(O.a,{onClick:s,children:"Like"}),Object(D.jsx)(y.a,{size:"small","aria-label":"close",color:"inherit",onClick:function(e,t){return a(e,t)},children:Object(D.jsx)(B.a,{fontSize:"small"})})]}),c=function(e){var t="First Lastname email.address@domain.com";if(e){var r=e.data,a=r.firstName,n=r.lastName,s=r.email;t="".concat(a," ").concat(n," ").concat(s)}return t}(r);return Object(D.jsx)(R.a,{open:t,message:c,action:i})},q=function(e){Object(f.a)(r,e);var t=Object(k.a)(r);function r(e){var a;return Object(b.a)(this,r),(a=t.call(this,e)).likeFormSubmission=Object(d.a)(l.a.mark((function e(){var t,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.lastSubmittedForm,r=Object(m.a)(Object(m.a)({},t),{},{data:Object(m.a)(Object(m.a)({},t.data),{},{liked:!0})}),a.addLikedFormLocally(r),e.prev=3,e.next=6,J(r);case 6:a.persistLikedForms(),a.hydrateLikedForms(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),a.retryUntilSucceeded(J,[r]);case 13:a.closeSnackbar();case 14:case"end":return e.stop()}}),e,null,[[3,10]])}))),a.state={likedFormSubmissions:a.getPersistedLikedForms(),bShowSnackbar:!1,lastSubmittedForm:null},a}return Object(h.a)(r,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.hydrateLikedForms();case 2:r=function(e){return t.onFormSubmitted(e)},T.push(r);case 3:case"end":return e.stop()}var r}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.persistLikedForms(),this.tearDownSnackbarTimer()}},{key:"hydrateLikedForms",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I();case 3:t=e.sent,e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(0),e.next=10,this.retryUntilSucceeded(I,[],-1);case 10:t=e.sent;case 11:t&&this.setState({likedFormSubmissions:t.formSubmissions});case 12:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"onFormSubmitted",value:function(e){this.setState({lastSubmittedForm:e}),this.openSnackbarFor5Seconds()}},{key:"addLikedFormLocally",value:function(e){this.setState({likedFormSubmissions:[].concat(Object(o.a)(this.state.likedFormSubmissions),[e])})}},{key:"retryUntilSucceeded",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var r,a,n,s=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>1&&void 0!==s[1]?s[1]:[],0!==(a=s.length>2&&void 0!==s[2]?s[2]:3)){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,t.apply(void 0,Object(o.a)(r));case 7:n=e.sent,e.next=15;break;case 10:return e.prev=10,e.t0=e.catch(4),e.next=14,this.retryUntilSucceeded(t,r,a-1);case 14:n=e.sent;case 15:return e.abrupt("return",n);case 16:case"end":return e.stop()}}),e,this,[[4,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"tearDownSnackbarTimer",value:function(){this.snackbarTimerId&&clearTimeout(this.snackbarTimerId)}},{key:"closeSnackbar",value:function(){this.state.bShowSnackbar&&this.setState({bShowSnackbar:!1})}},{key:"openSnackbarFor5Seconds",value:function(){var e=this;this.tearDownSnackbarTimer(),this.setState({bShowSnackbar:!0}),this.snackbarTimerId=setTimeout((function(){return e.closeSnackbar()}),5e3)}},{key:"persistLikedForms",value:function(){window.localStorage.setItem("likedFormSubmissions",JSON.stringify(this.state.likedFormSubmissions))}},{key:"getPersistedLikedForms",value:function(){return JSON.parse(localStorage.getItem("likedFormSubmissions"))||[]}},{key:"handleCloseSnackbar",value:function(e,t){"clickaway"!==t&&this.closeSnackbar()}},{key:"render",value:function(){return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(M,{}),Object(D.jsx)(S.a,{children:Object(D.jsx)(E,{likedForms:this.state.likedFormSubmissions})}),Object(D.jsx)(W,{open:this.state.bShowSnackbar,lastSubmittedForm:this.state.lastSubmittedForm,onClose:this.handleCloseSnackbar,onLike:this.likeFormSubmission})]})}}]),r}(n.a.Component),A=q;i.a.render(Object(D.jsxs)(n.a.StrictMode,{children:[Object(D.jsx)(c.a,{}),Object(D.jsx)(A,{})]}),document.getElementById("root"))}},[[91,1,2]]]);
//# sourceMappingURL=main.321a6ecf.chunk.js.map